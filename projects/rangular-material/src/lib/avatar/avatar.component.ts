import {AfterViewInit, ChangeDetectionStrategy, ChangeDetectorRef, Component, Input} from '@angular/core';
import {isNullOrUndefined} from 'rangular-common';

@Component({
  selector: 'ran-avatar',
  templateUrl: './avatar.component.html',
  styleUrls: ['./avatar.component.scss'],
  changeDetection: ChangeDetectionStrategy.OnPush,
})
export class AvatarComponent implements AfterViewInit {

  _data: string;
  data: string;

  // tslint:disable-next-line:max-line-length
  fallback = 'data:image/jpeg;base64,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';

  constructor(private changeDetector: ChangeDetectorRef) {
  }

  /**
   * Set image src.
   * @param data is the url or base64.
   */
  @Input()
  set src(data: string) {
    this._data = data;
    if (!isNullOrUndefined(data)) {
      this.ngAfterViewInit();
    }
  }

  ngAfterViewInit() {
    if (!isNullOrUndefined(this._data)) {
      this.data = this._data;
    } else {
      this.data = this.fallback;
    }
    this.changeDetector.markForCheck();
  }
}
